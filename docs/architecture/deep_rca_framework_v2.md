# Deep RCA Framework v2.0 - æ¶æ§‹è¨­è¨ˆæ–‡ä»¶

> **è¨­è¨ˆåŸå‰‡**ï¼šå¾ã€Œå°å­¸ç”Ÿç­‰ç´šçš„å› æœåˆ†æã€å‡ç´šç‚ºã€Œå°ˆæ¥­ç´šç³»çµ±æ€§æ ¹å› åˆ†æã€

## ç›®éŒ„

1. [å•é¡Œè¨ºæ–·ï¼šç›®å‰ç³»çµ±çš„ä¸è¶³](#1-å•é¡Œè¨ºæ–·)
2. [è¨­è¨ˆç›®æ¨™ï¼šæ·±åº¦ RCA çš„æ ¸å¿ƒç‰¹å¾µ](#2-è¨­è¨ˆç›®æ¨™)
3. [äº”å±¤åˆ†ææ¶æ§‹](#3-äº”å±¤åˆ†ææ¶æ§‹)
4. [æ–°å¢å·¥å…·è¦æ ¼](#4-æ–°å¢å·¥å…·è¦æ ¼)
5. [æ•´åˆç¾æœ‰å·¥å…·](#5-æ•´åˆç¾æœ‰å·¥å…·)
6. [å¯¦ä½œå„ªå…ˆé †åº](#6-å¯¦ä½œå„ªå…ˆé †åº)
7. [DDD æ¨¡çµ„è¨­è¨ˆ](#7-ddd-æ¨¡çµ„è¨­è¨ˆ)

---

## 1. å•é¡Œè¨ºæ–·

### 1.1 ç›®å‰ç³»çµ±çš„é™åˆ¶

| å•é¡Œ | èªªæ˜ | å½±éŸ¿ |
|------|------|------|
| **æ·ºå±¤åˆ†æ** | 5-Why åªåšå–®ç·šæ¨å°ï¼Œç¼ºä¹å¤šè§’åº¦é©—è­‰ | å®¹æ˜“ç”¢ç”Ÿåèª¤ï¼Œåªçœ‹åˆ°å†°å±±ä¸€è§’ |
| **ç¼ºä¹æ–‡ç»æ”¯æŒ** | æ²’æœ‰ RAG æ•´åˆï¼Œç„¡æ³•å¼•ç”¨ç›¸é—œç ”ç©¶ | åˆ†æç¼ºä¹ç§‘å­¸ä¾æ“šï¼ŒèªªæœåŠ›ä¸è¶³ |
| **å–®ä¸€æ¨¡å‹** | åªæœ‰ 5-Why + Fishboneï¼Œç¼ºä¹ç³»çµ±æ€§æ€ç¶­ | ç„¡æ³•è­˜åˆ¥ç³»çµ±æ€§æ¼æ´ |
| **ç„¡é©—è­‰æ©Ÿåˆ¶** | è­˜åˆ¥çš„æ ¹å› æ²’æœ‰ä¸‰è§’é©—è­‰ | å¯èƒ½èª¤åˆ¤æˆ–éºæ¼çœŸæ­£æ ¹å›  |
| **ç¼ºä¹è¡Œå‹•æŒ‡å¼•** | åªåˆ†æåŸå› ï¼Œä¸æä¾›é˜²è­·æªæ–½å»ºè­° | åˆ†æå®Œä¸çŸ¥é“ä¸‹ä¸€æ­¥æ€éº¼åš |

### 1.2 å°ˆæ¥­ RCA æ‡‰æœ‰çš„èƒ½åŠ›

æ ¹æ“š TJC (The Joint Commission)ã€AHRQã€WHO çš„ RCA æŒ‡å¼•ï¼Œå°ˆæ¥­åˆ†ææ‡‰åŒ…å«ï¼š

- **å¤šæ–¹æ³•è«–æ•´åˆ**ï¼šSwiss Cheese, Bowtie, Systems Thinking
- **æ–‡ç»åŸºç¤**ï¼šå¼•ç”¨ç›¸é—œæ¡ˆä¾‹ç ”ç©¶å’Œæœ€ä½³å¯¦è¸
- **è­‰æ“šä¸‰è§’é©—è­‰**ï¼šå¤šä¾†æºäº¤å‰é©—è­‰
- **ç³»çµ±æ€§é˜²è­·å»ºè­°**ï¼šBarrier Analysis, Leverage Points

---

## 2. è¨­è¨ˆç›®æ¨™

### 2.1 æ ¸å¿ƒé¡˜æ™¯

```
[ç›®å‰] åŸºæœ¬å› æœéˆ (5-Why) + åˆ†é¡ (Fishbone/HFACS)
           â†“
           â†“ å‡ç´š
           â†“
[ç›®æ¨™] å¤šå±¤æ¬¡ç³»çµ±åˆ†æ + æ–‡ç»è¼”åŠ© + é©—è­‰æ©Ÿåˆ¶ + è¡Œå‹•å»ºè­°
```

### 2.2 æˆåŠŸæ¨™æº–

| æŒ‡æ¨™ | åŸºæœ¬ç‰ˆ (v1) | æ·±åº¦ç‰ˆ (v2) |
|------|-------------|-------------|
| åˆ†ææ·±åº¦ | å–®ç·š 5-Why | å¤šè§’åº¦ + æ–‡ç»ä½è­‰ |
| é©—è­‰å¼·åº¦ | äººå·¥åˆ¤æ–· | ä¸‰è§’é©—è­‰ + å› æœæ¸¬è©¦ |
| æ¨¡å‹æ•´åˆ | Fishbone only | Swiss Cheese + Bowtie |
| æ–‡ç»æ”¯æŒ | ç„¡ | PubMed RAG æ•´åˆ |
| è¼¸å‡ºå“è³ª | åŸå› åˆ—è¡¨ | å®Œæ•´å ±å‘Š + è¡Œå‹•è¨ˆç•« |

---

## 3. äº”å±¤åˆ†ææ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Layer 5: SYNTHESIS                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚ Barrier     â”‚ â”‚ Action      â”‚ â”‚ Report      â”‚              â”‚
â”‚   â”‚ Analysis    â”‚ â”‚ Priorities  â”‚ â”‚ Generation  â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Layer 4: VALIDATION                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚ Evidence    â”‚ â”‚ Counterfact â”‚ â”‚ Expert      â”‚              â”‚
â”‚   â”‚ Triangulate â”‚ â”‚ Testing     â”‚ â”‚ Consensus   â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Layer 3: MULTI-MODEL ANALYSIS                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚ Swiss       â”‚ â”‚ Bowtie      â”‚ â”‚ Systems     â”‚              â”‚
â”‚   â”‚ Cheese      â”‚ â”‚ Analysis    â”‚ â”‚ Dynamics    â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Layer 2: KNOWLEDGE ENRICHMENT                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚ PubMed      â”‚ â”‚ Case        â”‚ â”‚ Best        â”‚              â”‚
â”‚   â”‚ RAG Search  â”‚ â”‚ Matching    â”‚ â”‚ Practice DB â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Layer 1: EVIDENCE GATHERING [å·²å®Œæˆ]          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚   â”‚ 5-Why       â”‚ â”‚ Fishbone    â”‚ â”‚ HFACS       â”‚              â”‚
â”‚   â”‚ Analysis    â”‚ â”‚ 6M Diagram  â”‚ â”‚ Classify    â”‚              â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.1 Layer 1: Evidence Gathering (âœ… å·²å®Œæˆ)

**ç›®çš„**ï¼šæ”¶é›†å’Œçµæ§‹åŒ–åŸå§‹è­‰æ“š

| å·¥å…· | ç‹€æ…‹ | åŠŸèƒ½ |
|------|------|------|
| `rc_ask_why` | âœ… | 5-Why æ·±åº¦åˆ†æ |
| `rc_init_fishbone` | âœ… | é­šéª¨åœ–åˆå§‹åŒ– |
| `rc_add_cause` | âœ… | æ–°å¢åŸå› åˆ°åˆ†é¡ |
| `rc_suggest_hfacs` | âœ… | HFACS åˆ†é¡å»ºè­° |
| `rc_verify_causation` | âœ… | å› æœé—œä¿‚é©—è­‰ |

---

### 3.2 Layer 2: Knowledge Enrichment (â³ è¦åŠƒä¸­)

**ç›®çš„**ï¼šç”¨æ–‡ç»å’Œæ¡ˆä¾‹åº«è±å¯Œåˆ†æ

#### 3.2.1 PubMed RAG æ•´åˆ

```python
# æ–°å·¥å…·ï¼šrc_enrich_with_literature
def rc_enrich_with_literature(
    session_id: str,
    cause_id: str,           # è¦è±å¯Œçš„åŸå›  ID
    search_strategy: str = "auto"  # auto, mesh_terms, free_text
) -> LiteratureEnrichment:
    """
    å°å–®ä¸€åŸå› é€²è¡Œæ–‡ç»æœå°‹ï¼Œè¿”å›ï¼š
    - ç›¸é—œ PubMed æ–‡ç«  (top 5)
    - é¡ä¼¼æ¡ˆä¾‹ç ”ç©¶
    - å»ºè­°çš„ MeSH è¡“èª
    - å¼•ç”¨æ‘˜è¦
    """
```

**æ•´åˆé»**ï¼š

```
[rc_ask_why] â†’ æ–°å¢ä¸€å€‹ Why ç­”æ¡ˆ
       â†“
[rc_enrich_with_literature] â†’ è‡ªå‹•æœå°‹ PubMed
       â†“
è¿”å›ç›¸é—œæ–‡ç»ï¼Œè‡ªå‹•é™„åŠ åˆ° WhyNode.evidence
```

#### 3.2.2 æ¡ˆä¾‹åŒ¹é…å¼•æ“

```python
# æ–°å·¥å…·ï¼šrc_match_similar_cases
def rc_match_similar_cases(
    session_id: str,
    top_k: int = 5
) -> list[SimilarCase]:
    """
    æ ¹æ“šç•¶å‰åˆ†æï¼Œå¾å…§éƒ¨æ¡ˆä¾‹åº«æ‰¾ç›¸ä¼¼æ¡ˆä¾‹
    - åŸºæ–¼ HFACS åˆ†é¡ç›¸ä¼¼åº¦
    - åŸºæ–¼é—œéµå­—åŒ¹é…
    - è¿”å›æ­·å²æ¡ˆä¾‹çš„è™•ç†æ–¹å¼å’Œçµæœ
    """
```

#### 3.2.3 æœ€ä½³å¯¦è¸è³‡æ–™åº«

```yaml
# config/best_practices/critical_results.yaml
category: Critical Test Result Management
source: TJC NPSG.02.03.01
practices:
  - id: CTR-001
    title: "Closed-loop Communication for Critical Results"
    description: "..."
    barriers:
      - Hard stop in EHR requiring acknowledgment
      - Time-based escalation protocol
      - Secondary notification to department head
    references:
      - pmid: "28123456"
      - pmid: "29234567"
```

---

### 3.3 Layer 3: Multi-Model Analysis (â³ è¦åŠƒä¸­)

**ç›®çš„**ï¼šç”¨å¤šç¨®åˆ†ææ¨¡å‹äº¤å‰é©—è­‰

#### 3.3.1 Swiss Cheese Model

```
äº‹ä»¶ç™¼ç”Ÿ
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ çµ„ç¹”å› ç´                                           â”‚
â”‚ â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹    â† å­”æ´ = éƒ¨é–€æœ¬ä½æ–‡åŒ–â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç›£ç£å› ç´                                           â”‚
â”‚ â—‹â”€â”€â”€â—â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹    â† å­”æ´ = ç¼ºä¹è¿½è¹¤æ©Ÿåˆ¶â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å‰ç½®æ¢ä»¶                                          â”‚
â”‚ â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—â”€â”€â”€â—‹â”€â”€â”€â—‹    â† å­”æ´ = ç´™æœ¬æµç¨‹   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸å®‰å…¨è¡Œç‚º                                        â”‚
â”‚ â—‹â”€â”€â”€â—‹â”€â”€â”€â—â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹â”€â”€â”€â—‹    â† å­”æ´ = é†«å¸«æ—©é€€  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
ä¸è‰¯äº‹ä»¶ï¼šç—…æ‚£å»¶èª¤è¨ºæ–· 44 å¤©
```

```python
# æ–°å·¥å…·ï¼šrc_build_swiss_cheese
def rc_build_swiss_cheese(session_id: str) -> SwissCheeseModel:
    """
    å¾ Fishbone/5-Why è‡ªå‹•å»ºæ§‹ Swiss Cheese æ¨¡å‹
    
    è¼¸å‡ºï¼š
    - å››å±¤é˜²è­· (Organizational â†’ Supervision â†’ Preconditions â†’ Unsafe Acts)
    - æ¯å±¤çš„å­”æ´ (å°æ‡‰å·²è­˜åˆ¥çš„åŸå› )
    - å­”æ´å°é½Šè»Œè·¡ (äº‹ä»¶ç©¿é€è·¯å¾‘)
    - é˜²è­·å»ºè­° (å¡«è£œæ¯å±¤å­”æ´çš„æªæ–½)
    """
```

#### 3.3.2 Bowtie Analysis

```
                        é ‚å±¤äº‹ä»¶
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ å»¶èª¤è¨ºæ–·  â”‚
                     â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                      â”‚                      â”‚
å¨è„… (Threats)             â”‚              å¾Œæœ (Consequences)
    â”‚                      â”‚                      â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”              â”Œâ”€â”€â”€â”´â”€â”€â”€â”              â”Œâ”€â”€â”€â”´â”€â”€â”€â”
â”‚é†«å¸«ç–å¿½â”‚              â”‚ å ±å‘Š  â”‚              â”‚ç—…æƒ…æƒ¡åŒ–â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ æœªå‚³é”â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”˜
    â†‘                  â””â”€â”€â”€â”€â”€â”€â”€â”˜                  â†‘
    â”‚                                             â”‚
é é˜²å±éšœ                                      æ¸›ç·©å±éšœ
 (Barriers)                                  (Barriers)
    â”‚                                             â”‚
â”Œâ”€â”€â”€â”´â”€â”€â”€â”                                    â”Œâ”€â”€â”€â”´â”€â”€â”€â”
â”‚è‡ªå‹•æé†’â”‚                                    â”‚å¿«é€Ÿè¿½è¹¤â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜                                    â””â”€â”€â”€â”€â”€â”€â”€â”˜
```

```python
# æ–°å·¥å…·ï¼šrc_build_bowtie
def rc_build_bowtie(
    session_id: str,
    top_event: str = "auto"  # è‡ªå‹•å¾å•é¡Œæè¿°æå–
) -> BowtieModel:
    """
    å»ºæ§‹ Bowtie åˆ†æåœ–
    
    è¼¸å‡ºï¼š
    - é ‚å±¤äº‹ä»¶ (Hazard/Top Event)
    - å·¦å´å¨è„… + é é˜²å±éšœ
    - å³å´å¾Œæœ + æ¸›ç·©å±éšœ
    - å±éšœå¼·åº¦è©•ä¼°
    - å±éšœç¼ºå£è­˜åˆ¥
    """
```

#### 3.3.3 ç³»çµ±å‹•åŠ›å­¸è¦–è§’

```python
# æ–°å·¥å…·ï¼šrc_analyze_feedback_loops
def rc_analyze_feedback_loops(session_id: str) -> SystemDynamicsAnalysis:
    """
    è­˜åˆ¥ç³»çµ±ä¸­çš„æ­£å‘/è² å‘å›é¥‹è¿´è·¯
    
    ç¯„ä¾‹è¼¸å‡ºï¼š
    è² å‘è¿´è·¯ (æƒ¡æ€§å¾ªç’°):
    é†«å¸«å¿™ç¢Œ â†’ è·³éå¯©é–± â†’ å•é¡Œç´¯ç© â†’ æ›´å¿™ç¢Œ
    
    æ­£å‘è¿´è·¯ (è‰¯æ€§å¾ªç’°):
    ç³»çµ±æé†’ â†’ åŠæ™‚è™•ç† â†’ æ¸›å°‘ç·Šæ€¥äº‹ä»¶ â†’ æœ‰æ™‚é–“ä»”ç´°å¯©é–±
    """
```

---

### 3.4 Layer 4: Validation (â³ è¦åŠƒä¸­)

**ç›®çš„**ï¼šé©—è­‰åˆ†æçµè«–çš„å¯ä¿¡åº¦

#### 3.4.1 è­‰æ“šä¸‰è§’é©—è­‰

```python
# æ–°å·¥å…·ï¼šrc_triangulate_evidence
def rc_triangulate_evidence(
    session_id: str,
    root_cause_id: str
) -> TriangulationResult:
    """
    å°è­˜åˆ¥çš„æ ¹å› é€²è¡Œä¸‰è§’é©—è­‰
    
    é©—è­‰ä¾†æºï¼š
    1. æ–‡ä»¶è­‰æ“š (ç´€éŒ„ã€æ”¿ç­–ã€æµç¨‹æ–‡ä»¶)
    2. äººå“¡è­‰è© (å¾ 5-Why è¨ªè«‡å…§å®¹)
    3. ç³»çµ±æ•¸æ“š (æ™‚é–“æˆ³è¨˜ã€ç³»çµ±æ—¥èªŒ)
    4. æ–‡ç»æ”¯æŒ (PubMed ç›¸é—œç ”ç©¶)
    
    è¼¸å‡ºï¼š
    - è­‰æ“šæ”¶æ–‚åº¦åˆ†æ•¸ (0-100)
    - å„ä¾†æºæ”¯æŒç¨‹åº¦
    - çŸ›ç›¾æˆ–ç¼ºå¤±è­˜åˆ¥
    - å»ºè­°è£œå……çš„è­‰æ“š
    """
```

#### 3.4.2 åäº‹å¯¦æ¸¬è©¦ (âœ… å·²æœ‰åŸºç¤ç‰ˆ)

åŠ å¼·ç‰ˆï¼š

```python
# å¢å¼·ï¼šrc_verify_causation
def rc_verify_causation(
    session_id: str,
    cause: CauseEvent,
    effect: EffectEvent,
    verification_level: str = "comprehensive"
) -> EnhancedVerificationResult:
    """
    å¢å¼·ç‰ˆå› æœé©—è­‰
    
    æ–°å¢æ¸¬è©¦ï¼š
    - æ©Ÿåˆ¶åˆç†æ€§æ¸¬è©¦ (æ˜¯å¦æœ‰åˆç†çš„å› æœæ©Ÿåˆ¶)
    - åŠ‘é‡åæ‡‰æ¸¬è©¦ (åŸå› å¼·åº¦èˆ‡çµæœåš´é‡åº¦æ˜¯å¦ç›¸é—œ)
    - æ’é™¤æ›¿ä»£è§£é‡‹ (æ˜¯å¦æœ‰å…¶ä»–å¯èƒ½åŸå› )
    - æ–‡ç»ä¸€è‡´æ€§ (æ˜¯å¦èˆ‡å·²çŸ¥ç ”ç©¶ä¸€è‡´)
    """
```

#### 3.4.3 å°ˆå®¶å…±è­˜æ©Ÿåˆ¶

```python
# æ–°å·¥å…·ï¼šrc_expert_review
def rc_expert_review(
    session_id: str,
    reviewers: list[str] = ["medical", "safety", "quality"]
) -> ExpertReviewResult:
    """
    æ¨¡æ“¬å¤šå°ˆå®¶å¯©æŸ¥è§€é»
    
    è¼¸å‡ºï¼š
    - å„å°ˆå®¶è§’åº¦çš„è§€å¯Ÿ
    - å…±è­˜å€åŸŸ (ä¸€è‡´åŒæ„çš„æ ¹å› )
    - çˆ­è­°å€åŸŸ (éœ€é€²ä¸€æ­¥è¨è«–)
    - å»ºè­°çš„é¡å¤–èª¿æŸ¥
    """
```

---

### 3.5 Layer 5: Synthesis (â³ è¦åŠƒä¸­)

**ç›®çš„**ï¼šç”¢å‡ºå¯è¡Œå‹•çš„çµè«–å’Œå ±å‘Š

#### 3.5.1 å±éšœåˆ†æ

```python
# æ–°å·¥å…·ï¼šrc_barrier_analysis
def rc_barrier_analysis(session_id: str) -> BarrierAnalysis:
    """
    å°æ¯å€‹è­˜åˆ¥çš„æ ¹å› ï¼Œå»ºè­°å…·é«”çš„é˜²è­·å±éšœ
    
    å±éšœé¡å‹ï¼š
    - Physical: ç‰©ç†/è¨­å‚™å±¤é¢
    - Administrative: è¡Œæ”¿/æµç¨‹å±¤é¢  
    - Educational: æ•™è‚²/åŸ¹è¨“å±¤é¢
    - Technological: è³‡è¨Šç³»çµ±å±¤é¢
    
    è¼¸å‡ºï¼š
    - æ¯å€‹æ ¹å› çš„æ¨è–¦å±éšœ (æŒ‰å„ªå…ˆåº¦æ’åº)
    - å±éšœå¯¦æ–½é›£åº¦è©•ä¼°
    - é æœŸæ•ˆæœä¼°è¨ˆ
    - åƒè€ƒæœ€ä½³å¯¦è¸
    """
```

#### 3.5.2 è¡Œå‹•å„ªå…ˆçŸ©é™£

```python
# æ–°å·¥å…·ï¼šrc_prioritize_actions
def rc_prioritize_actions(session_id: str) -> ActionPriorityMatrix:
    """
    ä½¿ç”¨å½±éŸ¿-åŠªåŠ›çŸ©é™£æ’åºè¡Œå‹•é …ç›®
    
    è¼¸å‡ºï¼š
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ é«˜å½±éŸ¿/ä½åŠªåŠ› (Quick Wins) â”‚ é«˜å½±éŸ¿/é«˜åŠªåŠ› (Major Projects)â”‚
    â”‚ âœ… ç«‹å³åŸ·è¡Œ                 â”‚ ğŸ“‹ è¦åŠƒå¾ŒåŸ·è¡Œ                  â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ ä½å½±éŸ¿/ä½åŠªåŠ› (Fill-ins)   â”‚ ä½å½±éŸ¿/é«˜åŠªåŠ› (é¿å…)          â”‚
    â”‚ ğŸ”„ é–’æš‡æ™‚åŸ·è¡Œ               â”‚ âŒ æš«ä¸åŸ·è¡Œ                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    """
```

#### 3.5.3 RCA å ±å‘Šç”Ÿæˆ

```python
# æ–°å·¥å…·ï¼šrc_generate_report
def rc_generate_report(
    session_id: str,
    format: str = "markdown",  # markdown, html, pdf, pptx
    template: str = "tjc"       # tjc, ahrq, who, custom
) -> RCAReport:
    """
    ç”Ÿæˆå°ˆæ¥­ RCA å ±å‘Š
    
    åŒ…å«ï¼š
    1. åŸ·è¡Œæ‘˜è¦ (1 é )
    2. äº‹ä»¶æ™‚é–“ç·š
    3. åˆ†ææ–¹æ³•èªªæ˜
    4. è¦–è¦ºåŒ–åœ–è¡¨ (Fishbone, Why Tree, Swiss Cheese)
    5. æ ¹å› è­˜åˆ¥èˆ‡é©—è­‰
    6. æ–‡ç»å¼•ç”¨
    7. å»ºè­°è¡Œå‹•è¨ˆç•«
    8. è¿½è¹¤æŒ‡æ¨™
    
    åƒè€ƒæ¨¡æ¿ï¼šTJC Framework for RCA
    """
```

---

## 4. æ–°å¢å·¥å…·è¦æ ¼

### 4.1 å·¥å…·ç¸½è¦½

| Layer | å·¥å…·åç¨± | å„ªå…ˆåº¦ | è¤‡é›œåº¦ | ä¾è³´ |
|-------|----------|--------|--------|------|
| L2 | `rc_enrich_with_literature` | P0 | ä¸­ | PubMed MCP |
| L2 | `rc_match_similar_cases` | P1 | é«˜ | æ¡ˆä¾‹åº« |
| L3 | `rc_build_swiss_cheese` | P0 | ä¸­ | Fishbone |
| L3 | `rc_build_bowtie` | P1 | ä¸­ | Fishbone |
| L3 | `rc_analyze_feedback_loops` | P2 | é«˜ | 5-Why |
| L4 | `rc_triangulate_evidence` | P0 | ä¸­ | 5-Why |
| L4 | `rc_expert_review` | P2 | é«˜ | All |
| L5 | `rc_barrier_analysis` | P0 | ä¸­ | Swiss Cheese |
| L5 | `rc_prioritize_actions` | P1 | ä½ | Barrier |
| L5 | `rc_generate_report` | P0 | é«˜ | All |

### 4.2 P0 å·¥å…·è©³ç´°è¦æ ¼

#### 4.2.1 `rc_enrich_with_literature`

**è¼¸å…¥**:
```typescript
interface EnrichLiteratureInput {
  session_id: string;
  cause_id?: string;        // ç‰¹å®šåŸå› ï¼Œæˆ– null = å…¨éƒ¨åŸå› 
  search_depth: "shallow" | "deep";  // shallow=3ç¯‡, deep=10ç¯‡
}
```

**è¼¸å‡º**:
```typescript
interface LiteratureEnrichment {
  cause_id: string;
  search_query: string;
  articles: PubMedArticle[];
  key_findings: string[];
  mesh_terms: string[];
  relevance_score: number;  // 0-1
}
```

**æ•´åˆæµç¨‹**:
```
User: "ç‚ºä»€éº¼ Critical Finding æ²’æœ‰è¢«è¿½è¹¤ï¼Ÿ"
           â†“
[rc_ask_why] â†’ æ–°å¢ WhyNode
           â†“
[rc_enrich_with_literature] â†’ æœå°‹ "critical finding communication failure"
           â†“
è¿”å› 5 ç¯‡ç›¸é—œæ–‡ç«  + è‡ªå‹•é™„åŠ åˆ° WhyNode.evidence
           â†“
é¡¯ç¤ºçµ¦ç”¨æˆ¶ï¼š
  "æ‰¾åˆ° 5 ç¯‡ç›¸é—œç ”ç©¶æ”¯æŒæ­¤åˆ†æ:
   1. PMID:29234567 - Critical test result communication failures
   2. PMID:30345678 - Closed-loop communication in healthcare
   ..."
```

#### 4.2.2 `rc_build_swiss_cheese`

**é‚è¼¯æ˜ å°„** (HFACS â†’ Swiss Cheese):
```python
LAYER_MAPPING = {
    "OI": "Organizational Influences",   # Level 4
    "US": "Unsafe Supervision",          # Level 3
    "PC": "Preconditions",               # Level 2
    "UA": "Unsafe Acts",                 # Level 1
}
```

**è¼¸å‡ºæ ¼å¼**:
```typescript
interface SwissCheeseModel {
  layers: SwissCheeseLayer[];
  trajectory: TrajectoryPath;
  recommendations: LayerRecommendation[];
}

interface SwissCheeseLayer {
  level: number;          // 1-4
  name: string;           // "Organizational Influences"
  holes: Hole[];          // å­”æ´ = é˜²è­·å¤±æ•ˆé»
  intact_defenses: Defense[];  // å®Œæ•´çš„é˜²è­·
}

interface Hole {
  cause_id: string;       // å°æ‡‰çš„åŸå›  ID
  description: string;
  size: "small" | "medium" | "large";  // å­”æ´å¤§å° = é¢¨éšªç¨‹åº¦
  hfacs_code: string;
}
```

#### 4.2.3 `rc_triangulate_evidence`

**é©—è­‰çŸ©é™£**:
```
            â”‚ æ–‡ä»¶è­‰æ“š â”‚ äººå“¡è­‰è© â”‚ ç³»çµ±æ•¸æ“š â”‚ æ–‡ç»æ”¯æŒ â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
æ ¹å›  A     â”‚    âœ…    â”‚    âœ…    â”‚    âš ï¸    â”‚    âœ…    â”‚ å¼·é©—è­‰
æ ¹å›  B     â”‚    âœ…    â”‚    âŒ    â”‚    âŒ    â”‚    âœ…    â”‚ å¼±é©—è­‰
æ ¹å›  C     â”‚    âŒ    â”‚    âœ…    â”‚    âœ…    â”‚    âŒ    â”‚ ä¸­é©—è­‰
```

**è¼¸å‡º**:
```typescript
interface TriangulationResult {
  root_cause_id: string;
  convergence_score: number;  // 0-100
  evidence_sources: {
    documentary: { present: boolean; details: string };
    testimonial: { present: boolean; details: string };
    systemic: { present: boolean; details: string };
    literature: { present: boolean; pmids: string[] };
  };
  strength: "strong" | "moderate" | "weak";
  gaps: string[];  // ç¼ºå¤±çš„è­‰æ“š
  recommendations: string[];  // å»ºè­°è£œå……çš„èª¿æŸ¥
}
```

#### 4.2.4 `rc_barrier_analysis`

**å±éšœé¡å‹å®šç¾©**:
```yaml
barrier_types:
  physical:
    description: "ç‰©ç†è¨­å‚™æˆ–ç’°å¢ƒæ”¹è®Š"
    examples:
      - "å®‰è£è‡ªå‹•é—œé–‰é–€ç¦"
      - "è—¥å“æ¨™ç±¤é¡è‰²ç·¨ç¢¼"
    effectiveness: high
    cost: high
    
  administrative:
    description: "æ”¿ç­–ã€æµç¨‹æˆ–è¦ç¯„æ”¹è®Š"
    examples:
      - "é›™é‡æ ¸å°æ¸…å–®"
      - "æ¨™æº–ä½œæ¥­ç¨‹åºæ›´æ–°"
    effectiveness: medium
    cost: low
    
  educational:
    description: "åŸ¹è¨“æˆ–æ„è­˜æå‡"
    examples:
      - "å¹´åº¦å®‰å…¨åŸ¹è¨“"
      - "æ¡ˆä¾‹åˆ†äº«æœƒ"
    effectiveness: low
    cost: low
    
  technological:
    description: "è³‡è¨Šç³»çµ±æˆ–è‡ªå‹•åŒ–"
    examples:
      - "EHR å¼·åˆ¶æé†’"
      - "è‡ªå‹•åŒ–å·¥ä½œæµç¨‹"
    effectiveness: high
    cost: medium
```

#### 4.2.5 `rc_generate_report`

**TJC å ±å‘Šæ¨¡æ¿**:
```markdown
# æ ¹å› åˆ†æå ±å‘Š

## 1. åŸ·è¡Œæ‘˜è¦
[è‡ªå‹•ç”Ÿæˆï¼šå•é¡Œã€ä¸»è¦ç™¼ç¾ã€å»ºè­°è¡Œå‹• - é™ 200 å­—]

## 2. äº‹ä»¶æè¿°
### 2.1 äº‹ä»¶æ¦‚è¿°
[å¾ session æå–]
### 2.2 æ™‚é–“ç·š
[å¾ 5-Why æ™‚é–“æˆ³è¨˜ç”Ÿæˆ]

## 3. åˆ†ææ–¹æ³•
### 3.1 ä½¿ç”¨çš„å·¥å…·
- 5-Why åˆ†æ (æ·±åº¦: X)
- é­šéª¨åœ– (6 åˆ†é¡)
- HFACS-MES åˆ†é¡
- Swiss Cheese æ¨¡å‹
### 3.2 åƒèˆ‡äººå“¡
[å¾…æ‰‹å‹•å¡«å¯«]

## 4. ç™¼ç¾
### 4.1 é­šéª¨åœ–
[Mermaid åœ–è¡¨]
### 4.2 5-Why åˆ†ææ¨¹
[Mermaid åœ–è¡¨]
### 4.3 Swiss Cheese åˆ†æ
[Mermaid åœ–è¡¨]

## 5. æ ¹å› è­˜åˆ¥
### 5.1 å·²è­˜åˆ¥çš„æ ¹å› 
[åˆ—è¡¨ + é©—è­‰å¼·åº¦]
### 5.2 å› æœé©—è­‰çµæœ
[åäº‹å¯¦æ¸¬è©¦çµæœ]
### 5.3 æ–‡ç»æ”¯æŒ
[PubMed å¼•ç”¨]

## 6. å»ºè­°è¡Œå‹•
### 6.1 å±éšœåˆ†æ
[æŒ‰é¡å‹åˆ†çµ„çš„å»ºè­°]
### 6.2 å„ªå…ˆçŸ©é™£
[å½±éŸ¿-åŠªåŠ›çŸ©é™£]
### 6.3 è¡Œå‹•è¨ˆç•«
[æ™‚é–“è¡¨ + è² è²¬äºº + æŒ‡æ¨™]

## 7. è¿½è¹¤
### 7.1 æˆæ•ˆæŒ‡æ¨™
### 7.2 è¿½è¹¤æ™‚ç¨‹

## é™„éŒ„
### A. å®Œæ•´ 5-Why è¨˜éŒ„
### B. æ‰€æœ‰å·²è­˜åˆ¥åŸå› 
### C. åƒè€ƒæ–‡ç»
```

---

## 5. æ•´åˆç¾æœ‰å·¥å…·

### 5.1 `rc_ask_why` å¢å¼·

```python
# æ–°å¢åƒæ•¸
def rc_ask_why(
    session_id: str,
    answer: str,
    evidence: list[str] = [],
    # === æ–°å¢ ===
    auto_enrich: bool = True,      # è‡ªå‹•æœå°‹æ–‡ç»
    auto_classify: bool = True,    # è‡ªå‹• HFACS åˆ†é¡
) -> EnhancedWhyResult:
    """
    å¢å¼·å¾Œæµç¨‹:
    1. å„²å­˜ç­”æ¡ˆåˆ° WhyChain
    2. [NEW] å¦‚æœ auto_classify=Trueï¼Œå‘¼å« rc_suggest_hfacs
    3. [NEW] å¦‚æœ auto_enrich=Trueï¼Œå‘¼å« rc_enrich_with_literature
    4. è¿”å›å¢å¼·çµæœ
    """
```

### 5.2 `rc_mark_root_cause` å¢å¼·

```python
def rc_mark_root_cause(
    session_id: str,
    node_id: str,
    confidence: float = 0.8,
    # === æ–°å¢ ===
    auto_triangulate: bool = True,  # è‡ªå‹•ä¸‰è§’é©—è­‰
    auto_barrier: bool = True,      # è‡ªå‹•å»ºè­°å±éšœ
) -> EnhancedRootCauseResult:
    """
    å¢å¼·å¾Œæµç¨‹:
    1. æ¨™è¨˜ç‚ºæ ¹å› 
    2. [NEW] å¦‚æœ auto_triangulate=Trueï¼Œå‘¼å« rc_triangulate_evidence
    3. [NEW] å¦‚æœ auto_barrier=Trueï¼Œå‘¼å« rc_barrier_analysis
    4. è¿”å›å¢å¼·çµæœ
    """
```

---

## 6. å¯¦ä½œå„ªå…ˆé †åº

### Phase 1: åŸºç¤æ·±åŒ– (2 é€±)

| Task | å·¥å…· | èªªæ˜ |
|------|------|------|
| 1.1 | `rc_enrich_with_literature` | æ•´åˆ PubMed MCP |
| 1.2 | `rc_triangulate_evidence` | è­‰æ“šä¸‰è§’é©—è­‰ |
| 1.3 | `rc_barrier_analysis` | åŸºæœ¬å±éšœå»ºè­° |
| 1.4 | `rc_generate_report` | Markdown å ±å‘Šç”Ÿæˆ |

### Phase 2: æ¨¡å‹æ“´å±• (2 é€±)

| Task | å·¥å…· | èªªæ˜ |
|------|------|------|
| 2.1 | `rc_build_swiss_cheese` | Swiss Cheese è¦–è¦ºåŒ– |
| 2.2 | `rc_build_bowtie` | Bowtie åˆ†æ |
| 2.3 | `rc_prioritize_actions` | è¡Œå‹•å„ªå…ˆçŸ©é™£ |

### Phase 3: æ™ºèƒ½å¢å¼· (2 é€±)

| Task | å·¥å…· | èªªæ˜ |
|------|------|------|
| 3.1 | `rc_match_similar_cases` | æ¡ˆä¾‹åŒ¹é…å¼•æ“ |
| 3.2 | `rc_expert_review` | å¤šå°ˆå®¶è¦–è§’ |
| 3.3 | `rc_analyze_feedback_loops` | ç³»çµ±å‹•åŠ›å­¸ |

---

## 7. DDD æ¨¡çµ„è¨­è¨ˆ

### 7.1 æ–°å¢ Domain Entities

```
src/rootcause_mcp/domain/
â”œâ”€â”€ entities/
â”‚   â”œâ”€â”€ swiss_cheese.py      # SwissCheeseModel, Layer, Hole
â”‚   â”œâ”€â”€ bowtie.py            # BowtieModel, Threat, Consequence
â”‚   â”œâ”€â”€ evidence.py          # Evidence, TriangulationResult
â”‚   â””â”€â”€ barrier.py           # Barrier, BarrierType
â”œâ”€â”€ value_objects/
â”‚   â”œâ”€â”€ literature.py        # PubMedArticle, SearchResult
â”‚   â””â”€â”€ priority.py          # PriorityLevel, EffortLevel
â””â”€â”€ services/
    â”œâ”€â”€ literature_enricher.py    # PubMed RAG æ•´åˆ
    â”œâ”€â”€ swiss_cheese_builder.py   # å¾ Fishbone å»ºæ§‹ Swiss Cheese
    â”œâ”€â”€ evidence_triangulator.py  # ä¸‰è§’é©—è­‰é‚è¼¯
    â””â”€â”€ barrier_suggester.py      # å±éšœå»ºè­°å¼•æ“
```

### 7.2 Infrastructure æ“´å±•

```
src/rootcause_mcp/infrastructure/
â”œâ”€â”€ external/
â”‚   â”œâ”€â”€ pubmed_client.py     # å‘¼å« PubMed MCP
â”‚   â””â”€â”€ best_practice_db.py  # è®€å–æœ€ä½³å¯¦è¸ YAML
â””â”€â”€ persistence/
    â”œâ”€â”€ swiss_cheese_repository.py
    â””â”€â”€ evidence_repository.py
```

### 7.3 æ–°å¢ Interface Handlers

```
src/rootcause_mcp/interface/handlers/
â”œâ”€â”€ literature_handlers.py    # rc_enrich_with_literature
â”œâ”€â”€ swiss_cheese_handlers.py  # rc_build_swiss_cheese
â”œâ”€â”€ bowtie_handlers.py        # rc_build_bowtie
â”œâ”€â”€ validation_handlers.py    # rc_triangulate_evidence
â”œâ”€â”€ barrier_handlers.py       # rc_barrier_analysis
â””â”€â”€ report_handlers.py        # rc_generate_report
```

---

## ä¸‹ä¸€æ­¥

1. **Review æ­¤è¨­è¨ˆæ–‡ä»¶** - ç¢ºèªæ¶æ§‹æ–¹å‘
2. **é¸æ“‡ Phase 1 å„ªå…ˆå¯¦ä½œ** - å¾ PubMed æ•´åˆé–‹å§‹
3. **å»ºç«‹ Domain Entities** - Swiss Cheese, Evidence, Barrier
4. **æ•´åˆæ¸¬è©¦** - ç”¨ç¾æœ‰çš„å»¶èª¤è¨ºæ–·æ¡ˆä¾‹æ¸¬è©¦

---

*æ–‡ä»¶ç‰ˆæœ¬: v2.0-draft*
*å»ºç«‹æ—¥æœŸ: 2026-01-16*
*ä½œè€…: AI Assistant + Human Review*
