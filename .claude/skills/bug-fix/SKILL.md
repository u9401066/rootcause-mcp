---
name: bug-fix
description: Structured bug fixing workflow with root cause analysis and regression prevention. Triggers: BF, ä¿® bug, fix bug, debug, é™¤éŒ¯, éŒ¯èª¤, error, å•é¡Œ, issue, ä¿®å¾©, fix, æ•…éšœ, fault, ç•°å¸¸, exception, å¤±æ•—, failure, ä¸èƒ½ç”¨, broken, å£æ‰.
version: 1.0.0
category: workflow
compatibility:
  - claude-code
  - github-copilot
  - vscode
  - codex-cli
orchestrates:
  - test-generator
  - code-reviewer
  - memory-updater
  - git-precommit
allowed-tools:
  - read_file
  - write_file
  - grep_search
  - semantic_search
  - run_in_terminal
  - get_errors
  - list_code_usages
---

# Bug ä¿®å¾©å·¥ä½œæµ

## æè¿°

çµæ§‹åŒ–çš„ Bug ä¿®å¾©æµç¨‹ï¼ŒåŒ…å«æ ¹å› åˆ†æå’Œå›æ­¸æ¸¬è©¦ã€‚

## è§¸ç™¼æ¢ä»¶

- ã€Œä¿® bugã€ã€Œfix bugã€ã€Œé™¤éŒ¯ã€
- ã€ŒBF: [å•é¡Œæè¿°]ã€

---

## ğŸ› Bug ä¿®å¾©æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Bug Fix Workflow                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 1: ğŸ” é‡ç¾ (Reproduce)                                 â”‚
â”‚  â”œâ”€ ç¢ºèªé‡ç¾æ­¥é©Ÿ                                             â”‚
â”‚  â”œâ”€ æ”¶é›†éŒ¯èª¤è¨Šæ¯/æ—¥èªŒ                                        â”‚
â”‚  â””â”€ å»ºç«‹æœ€å°é‡ç¾æ¡ˆä¾‹                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 2: ğŸ¯ å®šä½ (Locate)                                    â”‚
â”‚  â”œâ”€ åˆ†æéŒ¯èª¤å †ç–Š                                             â”‚
â”‚  â”œâ”€ è¿½è¹¤ç¨‹å¼ç¢¼è·¯å¾‘                                           â”‚
â”‚  â””â”€ è­˜åˆ¥å•é¡Œæ ¹å›                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 3: ğŸ§ª æ¸¬è©¦å…ˆè¡Œ (Test First)                            â”‚
â”‚  â”œâ”€ æ’°å¯«å¤±æ•—çš„æ¸¬è©¦æ¡ˆä¾‹                                       â”‚
â”‚  â”œâ”€ ç¢ºèªæ¸¬è©¦èƒ½é‡ç¾å•é¡Œ                                       â”‚
â”‚  â””â”€ é€™å°‡æˆç‚ºå›æ­¸æ¸¬è©¦                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 4: ğŸ”§ ä¿®å¾© (Fix)                                       â”‚
â”‚  â”œâ”€ å¯¦æ–½ä¿®å¾©                                                 â”‚
â”‚  â”œâ”€ æœ€å°åŒ–è®Šæ›´ç¯„åœ                                           â”‚
â”‚  â””â”€ ç¢ºèªæ¸¬è©¦é€šé                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 5: âœ… é©—è­‰ (Verify)                                    â”‚
â”‚  â”œâ”€ åŸ·è¡Œå®Œæ•´æ¸¬è©¦å¥—ä»¶                                         â”‚
â”‚  â”œâ”€ æª¢æŸ¥æ˜¯å¦å¼•å…¥æ–°å•é¡Œ                                       â”‚
â”‚  â””â”€ [code-reviewer] å¯©æŸ¥ä¿®å¾©                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Step 6: ğŸ“ è¨˜éŒ„ (Document)                                  â”‚
â”‚  â”œâ”€ æ›´æ–° Memory Bank                                        â”‚
â”‚  â”œâ”€ è¨˜éŒ„æ ¹å› åˆ†æ                                             â”‚
â”‚  â””â”€ æ›´æ–°ç›¸é—œæ–‡æª”                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ ä½¿ç”¨ç¯„ä¾‹

### åŸºæœ¬ç”¨æ³•

```
ã€Œä¿® bugï¼šç”¨æˆ¶ç™»å…¥æ™‚å‡ºç¾ 500 éŒ¯èª¤ã€

AI åŸ·è¡Œï¼š
1. ğŸ” è¦æ±‚æä¾›éŒ¯èª¤æ—¥èªŒå’Œé‡ç¾æ­¥é©Ÿ
2. ğŸ¯ åˆ†æå †ç–Šè¿½è¹¤ï¼Œå®šä½å•é¡Œ
3. ğŸ§ª å»ºç«‹å¤±æ•—æ¸¬è©¦æ¡ˆä¾‹
4. ğŸ”§ å¯¦æ–½ä¿®å¾©
5. âœ… é©—è­‰ä¿®å¾©
6. ğŸ“ è¨˜éŒ„ä¿®å¾©éç¨‹
```

### å¸¶éŒ¯èª¤è¨Šæ¯

```
ã€ŒBF: TypeError: 'NoneType' object is not subscriptable at line 45ã€

AI åŸ·è¡Œï¼š
1. è®€å–ç›¸é—œæª”æ¡ˆçš„ç¬¬ 45 è¡Œ
2. åˆ†æç‚ºä»€éº¼è®Šæ•¸æ˜¯ None
3. å»ºç«‹é‚Šç•Œæ¢ä»¶æ¸¬è©¦
4. åŠ å…¥ None æª¢æŸ¥æˆ–ä¿®æ­£é‚è¼¯
```

---

## ğŸ“Š è¼¸å‡ºæ ¼å¼

```markdown
## ğŸ› Bug ä¿®å¾©å ±å‘Š

### å•é¡Œæè¿°
ç”¨æˆ¶ç™»å…¥æ™‚å‡ºç¾ 500 Internal Server Error

### æ ¹å› åˆ†æ
- **ä½ç½®**: `src/application/services/auth_service.py:45`
- **åŸå› **: ç•¶ user ä¸å­˜åœ¨æ™‚ï¼Œç›´æ¥å­˜å– `user.password_hash` å°è‡´ NoneType éŒ¯èª¤
- **é¡å‹**: é‚Šç•Œæ¢ä»¶æœªè™•ç†

### ä¿®å¾©æ–¹æ¡ˆ

#### å›æ­¸æ¸¬è©¦ï¼ˆå…ˆæ’°å¯«ï¼‰
```python
def test_login_with_nonexistent_user():
    """ç™»å…¥ä¸å­˜åœ¨çš„ç”¨æˆ¶æ‡‰è¿”å› 401"""
    result = auth_service.login("nonexistent@test.com", "password")
    assert result.is_error
    assert result.error_code == "USER_NOT_FOUND"
```

#### ç¨‹å¼ç¢¼ä¿®å¾©
```python
# Before
def login(self, email: str, password: str):
    user = self.user_repo.find_by_email(email)
    if not bcrypt.verify(password, user.password_hash):  # ğŸ’¥ NoneType!
        ...

# After
def login(self, email: str, password: str):
    user = self.user_repo.find_by_email(email)
    if user is None:
        return Result.failure("USER_NOT_FOUND")
    if not bcrypt.verify(password, user.password_hash):
        ...
```

### é©—è­‰çµæœ
- âœ… å›æ­¸æ¸¬è©¦é€šé
- âœ… åŸæœ‰æ¸¬è©¦å¥—ä»¶é€šé (42/42)
- âœ… ç„¡æ–°å¢ lint éŒ¯èª¤

### é é˜²æªæ–½
- é¡ä¼¼çš„ None æª¢æŸ¥å·²åœ¨ 5 å€‹ç›¸é—œæ–¹æ³•ä¸­åŠ å…¥
- å»ºè­°ï¼šå•Ÿç”¨ mypy strict mode
```

---

## ğŸ¯ æ ¹å› åˆ†é¡

| é¡å‹ | æè¿° | é é˜² |
|------|------|------|
| **é‚Šç•Œæ¢ä»¶** | æœªè™•ç† null/empty/é‚Šç•Œå€¼ | åŠ å¼·é‚Šç•Œæ¸¬è©¦ |
| **ç«¶çˆ­æ¢ä»¶** | ä¸¦ç™¼å­˜å–å°è‡´ | åŠ å…¥é–å®šæ©Ÿåˆ¶ |
| **é¡å‹éŒ¯èª¤** | é¡å‹ä¸åŒ¹é… | å•Ÿç”¨ strict typing |
| **é‚è¼¯éŒ¯èª¤** | æ¥­å‹™é‚è¼¯ä¸æ­£ç¢º | åŠ å¼· domain æ¸¬è©¦ |
| **æ•´åˆå•é¡Œ** | å¤–éƒ¨æœå‹™äº’å‹• | åŠ å¼·æ•´åˆæ¸¬è©¦ |
